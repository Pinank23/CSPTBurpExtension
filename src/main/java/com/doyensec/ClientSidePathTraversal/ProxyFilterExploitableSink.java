package com.doyensec.ClientSidePathTraversal;

import burp.api.montoya.MontoyaApi;
import burp.api.montoya.http.message.requests.HttpRequest;
import burp.api.montoya.proxy.ProxyHistoryFilter;
import burp.api.montoya.proxy.ProxyHttpRequestResponse;

public class ProxyFilterExploitableSink implements ProxyHistoryFilter {
    private final String sinkHTTPMethod;
    private final String host;

    public ProxyFilterExploitableSink(String sinkHTTPMethod, String host) {
        this.host = host;
        this.sinkHTTPMethod = sinkHTTPMethod;
    }

    // Sink will be checked based on host and HTTP method
    @Override
    public boolean matches(ProxyHttpRequestResponse requestResponse) {
        HttpRequest httpRequest = requestResponse.finalRequest();

        // Filtering by host first will probably discard all irrelevant results quicker
        return httpRequest.httpService().host().equalsIgnoreCase(host) && httpRequest.method().equalsIgnoreCase(sinkHTTPMethod);
    }
}
