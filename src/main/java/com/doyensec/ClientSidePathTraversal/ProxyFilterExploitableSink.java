package com.doyensec.ClientSidePathTraversal;

import burp.api.montoya.MontoyaApi;
import burp.api.montoya.http.message.requests.HttpRequest;
import burp.api.montoya.proxy.ProxyHistoryFilter;
import burp.api.montoya.proxy.ProxyHttpRequestResponse;

public class ProxyFilterExploitableSink implements ProxyHistoryFilter {

    private String sinkHTTPMethod;
    private String host;

    MontoyaApi api;

    public ProxyFilterExploitableSink(MontoyaApi api, String sinkHTTPMethod, String host) {
        this.api = api;
        this.host = host;
        this.sinkHTTPMethod = sinkHTTPMethod;
    }

    // Sink will be checked based on host and HTTP method
    @Override
    public boolean matches(ProxyHttpRequestResponse requestResponse) {

        HttpRequest httpRequest = requestResponse.finalRequest();

        if (!httpRequest.method().equalsIgnoreCase(sinkHTTPMethod)) {
            return false;
        }

        if (!httpRequest.httpService().host().equalsIgnoreCase(host)) {
            return false;
        }

        return true;

    }

}
